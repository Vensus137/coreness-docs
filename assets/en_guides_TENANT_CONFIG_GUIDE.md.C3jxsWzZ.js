import{_ as s,o as i,c as n,af as t}from"./chunks/framework.DZTH9Z-c.js";const g=JSON.parse('{"title":"Tenant Configuration Guide","description":"Configuring tenants and Telegram bots in Coreness. Bot configuration, scenario organization, external repository synchronization.","frontmatter":{"title":"Tenant Configuration Guide","description":"Configuring tenants and Telegram bots in Coreness. Bot configuration, scenario organization, external repository synchronization.","keywords":"telegram bot setup, tenant configuration, multitenancy, github synchronization","head":[["meta",{"property":"og:title","content":"Tenant Configuration Guide | Coreness"}],["meta",{"property":"og:description","content":"Configuring tenants and Telegram bots in Coreness. Bot configuration, scenario organization, external repository synchronization."}],["meta",{"property":"og:image","content":"https://docs.coreness.tech/logo-dark.png"}],["meta",{"property":"og:url","content":"https://docs.coreness.tech/en/guides/TENANT_CONFIG_GUIDE"}],["link",{"rel":"canonical","href":"https://docs.coreness.tech/en/guides/TENANT_CONFIG_GUIDE"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"TechArticle\\",\\"headline\\":\\"Tenant Configuration Guide\\",\\"description\\":\\"Configuring tenants and Telegram bots in Coreness. Bot configuration, scenario organization, external repository synchronization.\\",\\"url\\":\\"https://docs.coreness.tech/en/guides/TENANT_CONFIG_GUIDE\\"}"]]},"headers":[],"relativePath":"en/guides/TENANT_CONFIG_GUIDE.md","filePath":"en/guides/TENANT_CONFIG_GUIDE.md"}'),e={name:"en/guides/TENANT_CONFIG_GUIDE.md"};function o(l,a,r,p,h,c){return i(),n("div",null,[...a[0]||(a[0]=[t(`<h1 id="tenant-configuration-guide" tabindex="-1">Tenant Configuration Guide <a class="header-anchor" href="#tenant-configuration-guide" aria-label="Permalink to &quot;Tenant Configuration Guide&quot;">â€‹</a></h1><p>â„¹ï¸ <strong>Purpose:</strong> Setting up tenants (clients) and their Telegram bots for working with the system.</p><h2 id="ğŸ“-configuration-structure" tabindex="-1">ğŸ“ Configuration Structure <a class="header-anchor" href="#ğŸ“-configuration-structure" aria-label="Permalink to &quot;ğŸ“ Configuration Structure&quot;">â€‹</a></h2><p>All tenants are located in one folder <code>config/tenant/</code>.</p><h3 id="tenant-folder-structure" tabindex="-1">Tenant Folder Structure <a class="header-anchor" href="#tenant-folder-structure" aria-label="Permalink to &quot;Tenant Folder Structure&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>config/tenant/</span></span>
<span class="line"><span>â”œâ”€â”€ tenant_101/                 # Public tenant (ID = 101)</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ bots/                   # Bot configs (e.g. Telegram, WhatsApp)</span></span>
<span class="line"><span>â”‚   â”‚   â””â”€â”€ telegram.yaml      # Telegram bot configuration</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ config.yaml             # Tenant configuration (optional)</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ storage/                # Tenant attributes storage (optional)</span></span>
<span class="line"><span>â”‚   â”‚   â””â”€â”€ ...                 # See STORAGE_CONFIG_GUIDE.md</span></span>
<span class="line"><span>â”‚   â””â”€â”€ scenarios/              # Scenarios (optional)</span></span>
<span class="line"><span>â”‚       â””â”€â”€ ...</span></span>
<span class="line"><span>â”œâ”€â”€ tenant_137/                 # Public tenant (ID = 137)</span></span>
<span class="line"><span>â”‚   â””â”€â”€ ...</span></span>
<span class="line"><span>â””â”€â”€ ...</span></span></code></pre></div><h3 id="tenant-types" tabindex="-1">Tenant Types <a class="header-anchor" href="#tenant-types" aria-label="Permalink to &quot;Tenant Types&quot;">â€‹</a></h3><ul><li><p><strong>System tenants</strong> (ID &lt; 100):</p><ul><li>Limited in changes</li><li>Managed by the system</li></ul></li><li><p><strong>Public tenants</strong> (ID â‰¥ 100):</p><ul><li>Synchronized with external <code>Repository-Tenant</code> repository</li><li>Fully managed through configuration</li><li>Used for client bots and public services</li></ul></li></ul><p>âš ï¸ <strong>IMPORTANT:</strong></p><ul><li>Folder name must strictly follow format <code>tenant_&lt;ID&gt;</code>, where <code>&lt;ID&gt;</code> is unique numeric tenant identifier</li><li>Folder structure is identical for all tenants regardless of type</li></ul><h2 id="ğŸ”„-tenant-synchronization" tabindex="-1">ğŸ”„ Tenant Synchronization <a class="header-anchor" href="#ğŸ”„-tenant-synchronization" aria-label="Permalink to &quot;ğŸ”„ Tenant Synchronization&quot;">â€‹</a></h2><p>Public tenants (ID â‰¥ 100) are synchronized with external <code>Repository-Tenant</code> repository through GitHub.</p><ul><li><strong>Update:</strong> Automatic synchronization with GitHub</li><li><strong>Management:</strong> Through system actions (<code>sync_all_tenants</code>, <code>sync_tenant</code>)</li><li><strong>Purpose:</strong> Client bots, public services</li><li><strong>Manual synchronization:</strong> Through system actions when needed</li></ul><h2 id="ğŸ¤–-bots-telegram-yaml" tabindex="-1">ğŸ¤– bots/telegram.yaml <a class="header-anchor" href="#ğŸ¤–-bots-telegram-yaml" aria-label="Permalink to &quot;ğŸ¤– bots/telegram.yaml&quot;">â€‹</a></h2><p><strong>Purpose:</strong> Telegram bot configuration for tenant. Stored in <code>bots/telegram.yaml</code> (folder <code>bots/</code> can contain configs for different bots).</p><h3 id="example-configuration" tabindex="-1">Example Configuration: <a class="header-anchor" href="#example-configuration" aria-label="Permalink to &quot;Example Configuration:&quot;">â€‹</a></h3><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># bots/telegram.yaml â€” Telegram bot configuration for tenant</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">bot_token</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1234567890:ABCdefGHIjklMNOpqrsTUVwxyz&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">is_active</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Bot commands (optional)</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">commands</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;start&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Main menu&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;all_private_chats&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;help&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Help&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;all_private_chats&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Commands for clearing (optional)</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">command_clear</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;all_private_chats&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # Clear commands in private chats</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;all_group_chats&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # Clear commands in group chats</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;chat&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                     # Clear commands in specific chat</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    chat_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123456789</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;chat_member&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # Clear commands for specific user in chat</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    chat_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123456789</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    user_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">987654321</span></span></code></pre></div><h3 id="parameters" tabindex="-1">Parameters: <a class="header-anchor" href="#parameters" aria-label="Permalink to &quot;Parameters:&quot;">â€‹</a></h3><ul><li><strong><code>bot_token</code></strong> â€” bot token from BotFather (optional)</li><li><strong><code>is_active</code></strong> â€” whether bot is active (true/false)</li></ul><h3 id="ğŸ’¡-storing-bot-token" tabindex="-1">ğŸ’¡ Storing Bot Token: <a class="header-anchor" href="#ğŸ’¡-storing-bot-token" aria-label="Permalink to &quot;ğŸ’¡ Storing Bot Token:&quot;">â€‹</a></h3><p>Bot token can be set in two ways:</p><ol><li><strong>Through configuration</strong> (<code>bots/telegram.yaml</code>) â€” during configuration synchronization, token from file is saved to database</li><li><strong>Through master bot</strong> â€” token can be set through master bot interface (bot must be created through configuration synchronization)</li></ol><p><strong>Priority:</strong> During configuration synchronization, token from <code>bots/telegram.yaml</code> has priority and updates token in database.</p><p><strong>ğŸ’¡ Life hack:</strong> You can set token once through configuration (<code>bots/telegram.yaml</code>), then remove it from file â€” token will remain in database and continue to be used. This allows not storing token in repository after initial setup.</p><ul><li><strong><code>commands</code></strong> â€” list of bot commands (optional): <ul><li><strong><code>command</code></strong> â€” command name (without /)</li><li><strong><code>description</code></strong> â€” command description</li><li><strong><code>scope</code></strong> â€” command scope: <ul><li><code>&quot;default&quot;</code> â€” default (private chats + groups)</li><li><code>&quot;all_private_chats&quot;</code> â€” all private chats</li><li><code>&quot;all_group_chats&quot;</code> â€” all group chats</li><li><code>&quot;chat&quot;</code> â€” specific chat (requires <code>chat_id</code>)</li><li><code>&quot;chat_member&quot;</code> â€” specific user in chat (requires <code>chat_id</code> and <code>user_id</code>)</li></ul></li></ul></li><li><strong><code>command_clear</code></strong> â€” list of scopes for clearing commands (optional): <ul><li><strong><code>scope</code></strong> â€” scope for clearing commands (same options as above)</li><li><strong><code>chat_id</code></strong> â€” chat ID (for scope: <code>chat</code>, <code>chat_member</code>)</li><li><strong><code>user_id</code></strong> â€” user ID (for scope: <code>chat_member</code>)</li></ul></li></ul><h3 id="important-features" tabindex="-1">Important Features: <a class="header-anchor" href="#important-features" aria-label="Permalink to &quot;Important Features:&quot;">â€‹</a></h3><ul><li><strong>Bot activation:</strong> Only bots with <code>is_active: true</code> will be started. Commands are automatically registered in Telegram on startup. Inactive bots are ignored by system</li><li><strong>Command scopes:</strong> Described in parameters above (<code>default</code>, <code>all_private_chats</code>, <code>all_group_chats</code>, <code>chat</code>, <code>chat_member</code>)</li></ul><h2 id="âš™ï¸-config-yaml" tabindex="-1">âš™ï¸ config.yaml <a class="header-anchor" href="#âš™ï¸-config-yaml" aria-label="Permalink to &quot;âš™ï¸ config.yaml&quot;">â€‹</a></h2><p><strong>Purpose:</strong> Tenant configuration with attributes (API keys, settings and other parameters).</p><h3 id="example-configuration-1" tabindex="-1">Example Configuration: <a class="header-anchor" href="#example-configuration-1" aria-label="Permalink to &quot;Example Configuration:&quot;">â€‹</a></h3><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Tenant configuration</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ai_token</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sk-or-v1-...&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # AI API key for tenant (optional)</span></span></code></pre></div><h3 id="parameters-1" tabindex="-1">Parameters: <a class="header-anchor" href="#parameters-1" aria-label="Permalink to &quot;Parameters:&quot;">â€‹</a></h3><ul><li><strong><code>ai_token</code></strong> â€” AI API key for tenant (optional) <ul><li>Used for actions requiring AI API key (e.g., <code>completion</code>, <code>embedding</code>, <code>save_embedding</code>)</li><li>If not specified, actions can use default key (if allowed in service settings)</li></ul></li></ul><h3 id="ğŸ’¡-storing-tenant-configuration" tabindex="-1">ğŸ’¡ Storing Tenant Configuration: <a class="header-anchor" href="#ğŸ’¡-storing-tenant-configuration" aria-label="Permalink to &quot;ğŸ’¡ Storing Tenant Configuration:&quot;">â€‹</a></h3><p>Tenant configuration can be set in two ways:</p><ol><li><strong>Through configuration</strong> (<code>config.yaml</code>) â€” during configuration synchronization, attributes from file are saved to database</li><li><strong>Through master bot</strong> â€” attributes can be updated through master bot interface (similar to bot token)</li></ol><p><strong>Priority:</strong> During configuration synchronization, attributes from <code>config.yaml</code> have priority and update values in database.</p><p><strong>ğŸ’¡ Life hack:</strong> You can set token once through configuration (<code>config.yaml</code>), then remove it from file â€” token will remain in database and continue to be used. This allows not storing token in repository after initial setup.</p><h3 id="usage-in-scenarios" tabindex="-1">Usage in Scenarios: <a class="header-anchor" href="#usage-in-scenarios" aria-label="Permalink to &quot;Usage in Scenarios:&quot;">â€‹</a></h3><p>All attributes from tenant configuration are automatically available in scenarios through special <code>_config</code> dictionary:</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">step</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;completion&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      prompt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Hello!&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # ai_token automatically taken from _config.ai_token</span></span></code></pre></div><p><strong>Access through placeholders:</strong></p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Token: {_config.ai_token|fallback:Not set}&quot;</span></span></code></pre></div><h2 id="ğŸ“‚-scenarios" tabindex="-1">ğŸ“‚ scenarios/ <a class="header-anchor" href="#ğŸ“‚-scenarios" aria-label="Permalink to &quot;ğŸ“‚ scenarios/&quot;">â€‹</a></h2><p><strong>Purpose:</strong> Organization of tenant scenarios. All YAML files from <code>scenarios/</code> folder (including subfolders) are automatically loaded. Subfolders can be used for logical file organization.</p><p>ğŸ“– <strong>Detailed guide:</strong> See <a href="./SCENARIO_CONFIG_GUIDE">SCENARIO_CONFIG_GUIDE.md</a></p><h2 id="ğŸ’¾-storage" tabindex="-1">ğŸ’¾ storage/ <a class="header-anchor" href="#ğŸ’¾-storage" aria-label="Permalink to &quot;ğŸ’¾ storage/&quot;">â€‹</a></h2><p><strong>Purpose:</strong> Tenant attributes storage (key-value structure for flexible storage of settings, limits, features and other data). Allows flexible tenant configuration management without changing DB schema.</p><p>ğŸ“– <strong>Detailed guide:</strong> See <a href="./STORAGE_CONFIG_GUIDE">STORAGE_CONFIG_GUIDE.md</a></p>`,49)])])}const k=s(e,[["render",o]]);export{g as __pageData,k as default};
