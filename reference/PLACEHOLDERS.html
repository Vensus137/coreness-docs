<!DOCTYPE html>
<html lang="ru" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Плейсхолдеры | Coreness</title>
    <meta name="description" content="Синтаксис плейсхолдеров, модификаторы и доступ к данным в сценариях Coreness.">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/assets/style.CGFLs5QR.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.1IewfOQU.js" defer></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.Dvsq6FN_.js">
    <link rel="modulepreload" href="/assets/chunks/framework.DZTH9Z-c.js">
    <link rel="modulepreload" href="/assets/reference_PLACEHOLDERS.md.BW8NJDzR.lean.js">
    <link rel="icon" type="image/png" href="/logo-dark.png" media="(prefers-color-scheme: dark)">
    <link rel="icon" type="image/png" href="/logo-light.png" media="(prefers-color-scheme: light)">
    <link rel="icon" type="image/png" href="/logo-dark.png">
    <meta name="keywords" content="Coreness, AI agents, Telegram bots, YAML, documentation, платформа, агенты, боты">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Coreness">
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"WebSite","name":"Coreness","url":"https://docs.coreness.tech","description":"Self-hosted multitenant platform for AI agents with event-driven architecture."}</script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"SoftwareApplication","name":"Coreness","description":"Self-hosted multitenant platform for AI agents with event-driven architecture.","url":"https://docs.coreness.tech","applicationCategory":"DeveloperApplication","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"}}</script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"dark",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
    <meta property="og:title" content="Плейсхолдеры | Coreness">
    <meta property="og:description" content="Синтаксис плейсхолдеров, модификаторы и доступ к данным в сценариях Coreness.">
    <meta property="og:image" content="https://docs.coreness.tech/logo-dark.png">
    <meta property="og:url" content="https://docs.coreness.tech/reference/PLACEHOLDERS">
    <link rel="canonical" href="https://docs.coreness.tech/reference/PLACEHOLDERS">
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"TechArticle","headline":"Плейсхолдеры","description":"Синтаксис плейсхолдеров, модификаторы и доступ к данным в сценариях Coreness.","url":"https://docs.coreness.tech/reference/PLACEHOLDERS"}</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0b0ada53></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0b0ada53>Skip to content</a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-6aa21345><div class="wrapper" data-v-6aa21345><div class="container" data-v-6aa21345><div class="title" data-v-6aa21345><div class="VPNavBarTitle has-sidebar" data-v-6aa21345 data-v-1168a8e4><a class="title" href="/" data-v-1168a8e4><!--[--><!--]--><!----><span data-v-1168a8e4>Coreness</span><!--[--><!--]--></a></div></div><div class="content" data-v-6aa21345><div class="content-body" data-v-6aa21345><!--[--><!--]--><div class="VPNavBarSearch search" data-v-6aa21345><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6aa21345 data-v-dc692963><span id="main-nav-aria-label" class="visually-hidden" data-v-dc692963> Main Navigation </span><!--[--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://coreness.tech" target="_blank" rel="noreferrer" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Coreness.tech</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://github.com/Vensus137/Coreness" target="_blank" rel="noreferrer" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>GitHub</span><!--]--></a><!--]--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-6aa21345 data-v-88af2de4 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="Change language" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><span class="vpi-languages option-icon" data-v-cf11d7a2></span><!----><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><div class="items" data-v-88af2de4><p class="title" data-v-88af2de4>Русский</p><!--[--><div class="VPMenuLink" data-v-88af2de4 data-v-35975db6><a class="VPLink link" href="/en/reference/PLACEHOLDERS" data-v-35975db6><!--[--><span data-v-35975db6>English</span><!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-6aa21345 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="true" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6aa21345 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/Vensus137/Coreness" aria-label="GitHub" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6aa21345 data-v-bb2aa2f0 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-cf11d7a2><span class="vpi-more-horizontal icon" data-v-cf11d7a2></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><div class="group translations" data-v-bb2aa2f0><p class="trans-title" data-v-bb2aa2f0>Русский</p><!--[--><div class="VPMenuLink" data-v-bb2aa2f0 data-v-35975db6><a class="VPLink link" href="/en/reference/PLACEHOLDERS" data-v-35975db6><!--[--><span data-v-35975db6>English</span><!--]--></a></div><!--]--></div><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Тема</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="true" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bb2aa2f0><div class="item social-links" data-v-bb2aa2f0><div class="VPSocialLinks social-links-list" data-v-bb2aa2f0 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/Vensus137/Coreness" aria-label="GitHub" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6aa21345 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-6aa21345><div class="divider-line" data-v-6aa21345></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Меню</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-8a42e2b4><button data-v-8a42e2b4>Вверх</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-319d5ca6><div class="curtain" data-v-319d5ca6></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-319d5ca6><span class="visually-hidden" id="sidebar-aria-label" data-v-319d5ca6> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0" data-v-c40bc020 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h2 class="text" data-v-b3fd67f8>Начало</h2><!----></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Главная</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/getting-started/" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Начало работы</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/getting-started/EXAMPLES_GUIDE" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Практические примеры</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/getting-started/MASTER_BOT_GUIDE" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Master Bot</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0" data-v-c40bc020 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h2 class="text" data-v-b3fd67f8>Развёртывание</h2><!----></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/getting-started/DEPLOYMENT" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Развёртывание</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0" data-v-c40bc020 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h2 class="text" data-v-b3fd67f8>Руководства</h2><!----></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/guides/SCENARIO_CONFIG_GUIDE" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Руководство по сценариям</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/guides/TENANT_CONFIG_GUIDE" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Конфигурация тенантов</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/guides/STORAGE_CONFIG_GUIDE" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Хранилище атрибутов</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 has-active" data-v-c40bc020 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h2 class="text" data-v-b3fd67f8>Справочники</h2><!----></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/reference/ACTION_GUIDE" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Гайд по действиям</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/reference/EVENT_GUIDE" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Гайд по событиям</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/reference/PLACEHOLDERS" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Плейсхолдеры</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/reference/AI_MODELS_GUIDE" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Модели AI</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0" data-v-c40bc020 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h2 class="text" data-v-b3fd67f8>Прочее</h2><!----></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/CHANGELOG" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Changelog</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 collapsible collapsed" data-v-c40bc020 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h2 class="text" data-v-b3fd67f8>Расширенная документация</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b3fd67f8><span class="vpi-chevron-right caret-icon" data-v-b3fd67f8></span></div></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/advanced/" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Обзор</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/advanced/ARCHITECTURE" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Архитектура</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/advanced/PLUGINS_GUIDE" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Плагины</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/advanced/PLUGIN_CONFIG_GUIDE" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Конфигурация плагинов</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/advanced/SYSTEM_ACTION_GUIDE" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Системные действия</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/advanced/SETTINGS_CONFIG_GUIDE" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Настройка системы</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/advanced/LOGGING_GUIDE" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Логирование</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/advanced/TESTING_GUIDE" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Тестирование</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>На этой странице</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _reference_PLACEHOLDERS" data-v-39a288b8><div><h1 id="плеисхолдеры" tabindex="-1">Плейсхолдеры <a class="header-anchor" href="#плеисхолдеры" aria-label="Permalink to &quot;Плейсхолдеры&quot;">​</a></h1><p><strong>Назначение:</strong> Динамическая подстановка значений в параметры действий сценариев.</p><h2 id="механика-работы" tabindex="-1">Механика работы: <a class="header-anchor" href="#механика-работы" aria-label="Permalink to &quot;Механика работы:&quot;">​</a></h2><p><strong>Все атрибуты в <code>params</code> автоматически обрабатываются плейсхолдерами</strong> перед выполнением действия. Это означает:</p><ul><li><strong>Все значения в <code>params</code></strong> — строки, числа, массивы, объекты — проходят через обработку плейсхолдеров</li><li><strong>Все уровни вложенности</strong> — плейсхолдеры работают на любом уровне структуры <code>params</code> (в строках, элементах массивов, значениях объектов)</li><li><strong>Автоматическая обработка</strong> — происходит для каждого шага сценария перед выполнением действия</li><li><strong>Источник данных</strong> — система использует накопленные данные события и результаты предыдущих действий как источник значений для подстановки</li></ul><h2 id="синтаксис-плеисхолдеров" tabindex="-1">Синтаксис плейсхолдеров: <a class="header-anchor" href="#синтаксис-плеисхолдеров" aria-label="Permalink to &quot;Синтаксис плейсхолдеров:&quot;">​</a></h2><p><strong>Простая замена:</strong></p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Привет, {username}!&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  chat_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{user_id}&quot;</span></span></code></pre></div><p><strong>С модификаторами:</strong></p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Привет, {username|fallback:Гость}!&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  price</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{amount|*0.9|format:currency}&quot;</span></span></code></pre></div><p><strong>Литеральные значения в кавычках:</strong></p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{&#39;hello&#39;|upper}&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                      # HELLO (без передачи через словарь)</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  duration</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{&#39;1d 2w&#39;|seconds}&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # 1296000 (литеральное время)</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  calculation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{&#39;100&#39;|+50}&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                   # 150 (литеральная арифметика)</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  date_shift</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{&#39;2024-12-25&#39;|shift:+1 day}&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 2024-12-26 (литеральная дата)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Двойные кавычки для строк с одинарными кавычками</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{&quot;it&#39;s working&quot;}&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                     # it&#39;s working</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Экранированные кавычки</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{&#39;it\&#39;s working&#39;}&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # it&#39;s working</span></span></code></pre></div><p><strong>Вложенные плейсхолдеры:</strong></p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Ответ: {status|equals:{expected}|value:OK|fallback:BAD}&quot;</span></span></code></pre></div><h3 id="⚠️-важно-кавычки-в-yaml-для-плеисхолдеров-с-regex" tabindex="-1">⚠️ Важно: Кавычки в YAML для плейсхолдеров с regex <a class="header-anchor" href="#⚠️-важно-кавычки-в-yaml-для-плеисхолдеров-с-regex" aria-label="Permalink to &quot;⚠️ Важно: Кавычки в YAML для плейсхолдеров с regex&quot;">​</a></h3><p><strong>Проблема:</strong> YAML по-разному обрабатывает escape-последовательности в одинарных и двойных кавычках, что критично для regex паттернов с обратными слешами.</p><p><strong>Решение:</strong> Используйте <strong>двойные кавычки</strong> для regex паттернов с обратными слешами (<code>\s</code>, <code>\d</code>, <code>\w</code> и т.д.).</p><p><strong>Примеры:</strong></p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ❌ ОШИБКА - в одинарных кавычках \\s не экранируется правильно</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;{event_text|regex:^([^\\s]+)|lower}&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # \\s становится \s (обратный слеш + s), а не пробел!</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ✅ ПРАВИЛЬНО - двойные кавычки правильно экранируют обратные слеши</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{event_text|regex:^([^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s]+)|lower}&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # \\s становится \s (пробел в regex)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ✅ ПРАВИЛЬНО - для regex без обратных слешей можно использовать одинарные кавычки</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  tenant_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;{user_state|regex:tenant_(\d+)}&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Работает, так как \d не требует двойного экранирования</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ✅ ПРАВИЛЬНО - для простых regex с одним обратным слешем тоже двойные кавычки</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{event_text|regex:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s+([^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s]+)$|lower}&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # \\s для пробела, \\s для пробела</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ✅ ОБЫЧНЫЕ ПЛЕЙСХОЛДЕРЫ - без разницы</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Привет, {username}!&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     # Работает</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Привет, {username}!&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Тоже работает</span></span></code></pre></div><p><strong>Когда использовать двойные кавычки:</strong></p><ul><li><strong>Regex паттерны с обратными слешами</strong> — <code>{field|regex:pattern}</code> где pattern содержит <code>\s</code>, <code>\d</code>, <code>\w</code>, <code>\n</code>, <code>\t</code> и т.д.</li><li><strong>Важно:</strong> В двойных кавычках нужно использовать двойное экранирование: <code>\\s</code> для пробела, <code>\\d</code> для цифры</li><li><strong>Пример:</strong> <code>&quot;{event_text|regex:^([^\\s]+)|lower}&quot;</code> — <code>\\s</code> становится <code>\s</code> (пробел в regex)</li></ul><p><strong>Когда можно использовать одинарные кавычки:</strong></p><ul><li><strong>Regex паттерны без обратных слешей</strong> — простые паттерны без <code>\s</code>, <code>\d</code>, <code>\w</code> и т.д.</li><li><strong>Обычные плейсхолдеры</strong> — <code>{username}</code>, <code>{user_id}</code></li><li><strong>Простые модификаторы</strong> — <code>{name|upper}</code>, <code>{price|format:currency}</code></li><li><strong>Текстовые значения</strong> — без специальных символов</li></ul><p><strong>Правило:</strong> Если в regex паттерне есть обратные слеши (<code>\s</code>, <code>\d</code>, <code>\w</code> и т.д.) — <strong>всегда используйте двойные кавычки</strong> с двойным экранированием (<code>\\s</code>, <code>\\d</code>, <code>\\w</code>).</p><p><strong>Доступ к вложенным данным:</strong></p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Точечная нотация для объектов</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Пользователь: {user.profile.name|fallback:Неизвестный}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Сообщение: {message.text}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Индексы для массивов</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Первый файл: {attachment[0].file_id}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Последний пользователь: {users[-1].name}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Комбинированный доступ</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Событие: {event.attachment[0].type}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Данные: {response.data.items[0].value}&quot;</span></span></code></pre></div><h2 id="доступные-данные" tabindex="-1">Доступные данные: <a class="header-anchor" href="#доступные-данные" aria-label="Permalink to &quot;Доступные данные:&quot;">​</a></h2><p><strong>Все данные события и предыдущих действий доступны для использования в плейсхолдерах:</strong></p><p><strong>Данные события:</strong></p><ul><li><strong><code>user_id</code></strong> — ID пользователя</li><li><strong><code>username</code></strong> — имя пользователя</li><li><strong><code>chat_id</code></strong> — ID чата</li><li><strong><code>event_text</code></strong> — текст сообщения</li><li><strong><code>callback_data</code></strong> — данные callback кнопки</li><li><strong><code>event_date</code></strong> — время события</li><li><strong><code>tenant_id</code></strong> — ID тенанта</li><li><strong><code>message_id</code></strong> — ID сообщения</li><li><strong><code>reply_to_message_id</code></strong> — ID сообщения, на которое отвечаем</li><li><strong><code>forward_from</code></strong> — данные о пересылке</li><li><strong>И любые другие поля</strong> — в зависимости от типа события</li></ul><p><strong>Конфигурация тенанта:</strong></p><ul><li><strong><code>_config</code></strong> — словарь с конфигурацией тенанта (атрибуты из <code>config.yaml</code>) <ul><li><strong><code>_config.openrouter_token</code></strong> — OpenRouter API ключ для тенанта (если установлен)</li><li><strong>Другие атрибуты</strong> — в зависимости от конфигурации тенанта</li><li>Автоматически доступен во всех сценариях тенанта</li></ul></li></ul><p><strong>Данные предыдущих действий:</strong></p><ul><li><strong><code>last_message_id</code></strong> — ID последнего отправленного сообщения</li><li><strong><code>response_data</code></strong> — любые данные, возвращённые предыдущими действиями</li><li><strong>Другие поля</strong> — в зависимости от действий в сценарии</li></ul><h2 id="доступ-к-вложенным-элементам" tabindex="-1">Доступ к вложенным элементам: <a class="header-anchor" href="#доступ-к-вложенным-элементам" aria-label="Permalink to &quot;Доступ к вложенным элементам:&quot;">​</a></h2><blockquote><p><strong>Универсальный доступ к данным!</strong> Поддержка точечной нотации для объектов и индексов для массивов.</p></blockquote><table><thead><tr><th>Синтаксис</th><th>Описание</th><th>Пример</th><th>Результат</th></tr></thead><tbody><tr><td colspan="4"><strong>Объекты</strong></td></tr><tr><td><code>object.field</code></td><td>Доступ к полю объекта</td><td><code>{message.text}</code></td><td><code>Привет мир</code></td></tr><tr><td><code>object.field.subfield</code></td><td>Вложенные поля</td><td><code>{user.profile.name}</code></td><td><code>Иван Петров</code></td></tr><tr><td colspan="4"><strong>Массивы</strong></td></tr><tr><td><code>array[index]</code></td><td>Доступ к элементу массива</td><td><code>{attachment[0].file_id}</code></td><td><code>file_1</code> (первый файл)</td></tr><tr><td><code>array[-index]</code></td><td>Отрицательный индекс</td><td><code>{attachment[-1].file_id}</code></td><td><code>file_3</code> (последний файл)</td></tr><tr><td><code>array[index].field</code></td><td>Поле элемента массива</td><td><code>{users[1].name}</code></td><td><code>Боб</code> (имя второго пользователя)</td></tr><tr><td><code>array[index][index]</code></td><td>Вложенные массивы</td><td><code>{matrix[0][1]}</code></td><td><code>2</code> (элемент матрицы)</td></tr><tr><td colspan="4"><strong>Комбинированный</strong></td></tr><tr><td><code>object.array[index].field</code></td><td>Смешанный доступ</td><td><code>{event.attachment[0].file_id}</code></td><td><code>file_1</code></td></tr></tbody></table><p><strong>Примеры использования:</strong></p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Объекты</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Сообщение: {message.text}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Пользователь: {user.profile.name|fallback:Неизвестный}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Массивы</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Первый файл: {attachment[0].file_id}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Последний пользователь: {users[-1].name|upper}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Файл: {attachment[0].file_id}, размер: {attachment[0].size}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Комбинированный доступ</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Событие: {event.attachment[0].type}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Данные: {response.data.items[0].value}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Конфигурация тенанта</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Токен: {_config.openrouter_token|fallback:Не установлен}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Безопасный доступ</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{attachment[10].file_id|fallback:Файл не найден}&quot;</span></span></code></pre></div><h2 id="получение-информации-о-фаиле" tabindex="-1">Получение информации о файле <a class="header-anchor" href="#получение-информации-о-фаиле" aria-label="Permalink to &quot;Получение информации о файле&quot;">​</a></h2><p><strong>Практический пример: получение file_id и type для пересылки файлов</strong></p><p>Создайте сценарий, который покажет file_id и type всех вложений из события:</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">file_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Получение file_id и type вложений для последующей пересылки&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  trigger</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">event_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;message&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      event_text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/file&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  step</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;send_message&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          📎 Информация о файле:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          file_id: &lt;code&gt;{event_attachment[0].file_id|fallback:{reply_attachment[0].file_id|fallback:Файл не найден}}&lt;/code&gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          type: &lt;code&gt;{event_attachment[0].type|fallback:{reply_attachment[0].type|fallback:Тип не найден}}&lt;/code&gt;</span></span></code></pre></div><p><strong>Обработка ошибок:</strong></p><ul><li>При обращении к несуществующему полю/индексу возвращается <code>None</code></li><li>Можно использовать модификатор <code>fallback</code> для значения по умолчанию</li><li>Отрицательные индексы работают как в Python: <code>-1</code> = последний элемент</li><li>Поддерживается неограниченная глубина вложенности</li></ul><h2 id="модификаторы" tabindex="-1">Модификаторы: <a class="header-anchor" href="#модификаторы" aria-label="Permalink to &quot;Модификаторы:&quot;">​</a></h2><table><thead><tr><th>Модификатор</th><th>Описание</th><th>Пример</th><th>Результат</th></tr></thead><tbody><tr><td colspan="4"><strong>Арифметические операции</strong></td></tr><tr><td><code>+value</code></td><td>Сложение</td><td><code>{price|+100}</code></td><td><code>1500</code> (если price=1400)</td></tr><tr><td><code>-value</code></td><td>Вычитание</td><td><code>{price|-50}</code></td><td><code>1350</code> (если price=1400)</td></tr><tr><td><code>*value</code></td><td>Умножение</td><td><code>{price|*0.9}</code></td><td><code>1260</code> (если price=1400)</td></tr><tr><td><code>/value</code></td><td>Деление</td><td><code>{seconds|/3600}</code></td><td><code>2.5</code> (если seconds=9000)</td></tr><tr><td><code>%value</code></td><td>Остаток от деления</td><td><code>{number|%7}</code></td><td><code>3</code> (если number=10)</td></tr><tr><td colspan="4"><strong>Регистр</strong></td></tr><tr><td><code>upper</code></td><td>Верхний регистр</td><td><code>{name|upper}</code></td><td><code>ИВАН</code> (если name=&quot;Иван&quot;)</td></tr><tr><td><code>lower</code></td><td>Нижний регистр</td><td><code>{name|lower}</code></td><td><code>иван</code> (если name=&quot;Иван&quot;)</td></tr><tr><td><code>title</code></td><td>Заглавные буквы каждого слова</td><td><code>{name|title}</code></td><td><code>Иван Петров</code> (если name=&quot;иван петров&quot;)</td></tr><tr><td><code>capitalize</code></td><td>Первая заглавная буква</td><td><code>{name|capitalize}</code></td><td><code>Иван</code> (если name=&quot;иван&quot;)</td></tr><tr><td><code>case:type</code></td><td>Преобразование регистра</td><td><code>{name|case:upper}</code></td><td><code>ИВАН</code> (если name=&quot;Иван&quot;)</td></tr><tr><td colspan="4"><strong>Списки</strong></td></tr><tr><td><code>tags</code></td><td>Преобразование в теги</td><td><code>{users|tags}</code></td><td><code>@user1 @user2</code></td></tr><tr><td><code>list</code></td><td>Маркированный список</td><td><code>{items|list}</code></td><td><code>• item1\n• item2</code></td></tr><tr><td><code>comma</code></td><td>Через запятую</td><td><code>{items|comma}</code></td><td><code>item1, item2</code></td></tr><tr><td><code>expand</code></td><td>Разворачивание массива массивов на один уровень (только в массивах)</td><td><code>{keyboard|expand}</code></td><td><code>[[a, b], [c]]</code> → <code>[a, b], [c]</code> (в массиве)</td></tr><tr><td><code>keys</code></td><td>Извлечение ключей из объекта (словаря) в массив</td><td><code>{storage_values|keys}</code></td><td><code>[&quot;group1&quot;, &quot;group2&quot;]</code> (если storage_values={&quot;group1&quot;: {...}, &quot;group2&quot;: {...}})</td></tr><tr><td colspan="4"><strong>Преобразования</strong></td></tr><tr><td><code>code</code></td><td>Оборачивание значения в code блок</td><td><code>{field|code}</code></td><td><code>&lt;code&gt;value&lt;/code&gt;</code></td></tr><tr><td colspan="4"><strong>Форматирование строк</strong></td></tr><tr><td><code>truncate:length</code></td><td>Обрезка текста</td><td><code>{text|truncate:50}</code></td><td><code>Очень длинный текст...</code></td></tr><tr><td colspan="4"><strong>Операции с датами и временем</strong></td></tr><tr><td><code>shift:±интервал</code></td><td>Сдвиг даты на интервал (PostgreSQL: +1 day, -2 hours, +1 year 2 months). Поддержка всех форматов дат, включая ISO с таймзоной, корректная обработка месяцев/лет</td><td><code>{created|shift:+1 day}</code></td><td><code>2024-12-26</code> (если created=&quot;2024-12-25&quot;)</td></tr><tr><td><code>seconds</code></td><td>Преобразование временных строк в секунды (формат: Xw Yd Zh Km Ms)</td><td><code>{duration|seconds}</code></td><td><code>9000</code> (если duration=&quot;2h 30m&quot;)</td></tr><tr><td><code>to_date</code></td><td>Приведение даты к началу дня (00:00:00), возвращает ISO формат</td><td><code>{created|to_date}</code></td><td><code>2024-12-25 00:00:00</code></td></tr><tr><td><code>to_hour</code></td><td>Приведение даты к началу часа (минуты и секунды = 0), возвращает ISO формат</td><td><code>{created|to_hour}</code></td><td><code>2024-12-25 15:00:00</code> (если created=&quot;2024-12-25 15:30:45&quot;)</td></tr><tr><td><code>to_minute</code></td><td>Приведение даты к началу минуты (секунды = 0), возвращает ISO формат</td><td><code>{created|to_minute}</code></td><td><code>2024-12-25 15:30:00</code> (если created=&quot;2024-12-25 15:30:45&quot;)</td></tr><tr><td><code>to_second</code></td><td>Приведение даты к началу секунды (микросекунды = 0), возвращает ISO формат</td><td><code>{created|to_second}</code></td><td><code>2024-12-25 15:30:45</code></td></tr><tr><td><code>to_week</code></td><td>Приведение даты к началу недели (понедельник 00:00:00), возвращает ISO формат</td><td><code>{created|to_week}</code></td><td><code>2024-12-23 00:00:00</code> (если created=&quot;2024-12-25 15:30:45&quot;)</td></tr><tr><td><code>to_month</code></td><td>Приведение даты к началу месяца (1 число, 00:00:00), возвращает ISO формат</td><td><code>{created|to_month}</code></td><td><code>2024-12-01 00:00:00</code> (если created=&quot;2024-12-25 15:30:45&quot;)</td></tr><tr><td><code>to_year</code></td><td>Приведение даты к началу года (1 января, 00:00:00), возвращает ISO формат</td><td><code>{created|to_year}</code></td><td><code>2024-01-01 00:00:00</code> (если created=&quot;2024-12-25 15:30:45&quot;)</td></tr><tr><td colspan="4"><strong>Форматирование дат и времени</strong></td></tr><tr><td><code>format:timestamp</code></td><td>Преобразование в Unix timestamp</td><td><code>{date|format:timestamp}</code></td><td><code>1703512200</code></td></tr><tr><td><code>format:date</code></td><td>Формат даты (dd.mm.yyyy)</td><td><code>{timestamp|format:date}</code></td><td><code>25.12.2024</code></td></tr><tr><td><code>format:time</code></td><td>Формат времени (HH:MM)</td><td><code>{timestamp|format:time}</code></td><td><code>14:30</code></td></tr><tr><td><code>format:time_full</code></td><td>Формат времени с секундами (HH:MM:SS)</td><td><code>{timestamp|format:time_full}</code></td><td><code>14:30:45</code></td></tr><tr><td><code>format:datetime</code></td><td>Полный формат (dd.mm.yyyy HH:MM)</td><td><code>{timestamp|format:datetime}</code></td><td><code>25.12.2024 14:30</code></td></tr><tr><td><code>format:datetime_full</code></td><td>Полный формат с секундами (dd.mm.yyyy HH:MM:SS)</td><td><code>{timestamp|format:datetime_full}</code></td><td><code>25.12.2024 14:30:45</code></td></tr><tr><td><code>format:pg_date</code></td><td>Формат даты для PostgreSQL (YYYY-MM-DD)</td><td><code>{timestamp|format:pg_date}</code></td><td><code>2024-12-25</code></td></tr><tr><td><code>format:pg_datetime</code></td><td>Формат даты и времени для PostgreSQL (YYYY-MM-DD HH:MM:SS)</td><td><code>{timestamp|format:pg_datetime}</code></td><td><code>2024-12-25 14:30:45</code></td></tr><tr><td colspan="4"><strong>Форматирование чисел</strong></td></tr><tr><td><code>format:currency</code></td><td>Форматирование валюты</td><td><code>{amount|format:currency}</code></td><td><code>1000.00 ₽</code></td></tr><tr><td><code>format:percent</code></td><td>Форматирование процентов</td><td><code>{value|format:percent}</code></td><td><code>25.5%</code></td></tr><tr><td><code>format:number</code></td><td>Форматирование чисел</td><td><code>{value|format:number}</code></td><td><code>1234.56</code></td></tr><tr><td colspan="4"><strong>Условные</strong></td></tr><tr><td><code>equals:value</code></td><td>Проверка равенства (строковое сравнение)</td><td><code>{status|equals:active}</code></td><td><code>true</code> или <code>false</code></td></tr><tr><td><code>in_list:items</code></td><td>Проверка вхождения в список</td><td><code>{role|in_list:admin,moderator}</code></td><td><code>true</code> или <code>false</code></td></tr><tr><td><code>true</code></td><td>Проверка истинности (рекомендуется для boolean)</td><td><code>{is_active|true}</code></td><td><code>true</code> или <code>false</code></td></tr><tr><td><code>exists</code></td><td>Проверка существования значения (не None и не пустая строка)</td><td><code>{field|exists}</code></td><td><code>true</code> или <code>false</code></td></tr><tr><td><code>is_null</code></td><td>Проверка на null (None, пустая строка или строка &quot;null&quot;)</td><td><code>{field|is_null}</code></td><td><code>true</code> или <code>false</code></td></tr><tr><td><code>value:result</code></td><td>Возврат значения при истинности</td><td><code>{status|equals:active|value:Активен}</code></td><td><code>Активен</code> или <code>null</code></td></tr><tr><td colspan="4"><strong>Служебные</strong></td></tr><tr><td><code>fallback:value</code></td><td>Значение по умолчанию</td><td><code>{username|fallback:Гость}</code></td><td><code>Иван</code> или <code>Гость</code></td></tr><tr><td><code>length</code></td><td>Подсчёт длины</td><td><code>{text|length}</code></td><td><code>15</code> (количество символов)</td></tr><tr><td><code>length</code></td><td>Подсчёт длины массива</td><td><code>{array|length}</code></td><td><code>3</code> (количество элементов)</td></tr><tr><td><code>regex:pattern</code></td><td>Извлечение по regex</td><td><code>{text|regex:(\d+)}</code></td><td><code>123</code> (первое число)</td></tr><tr><td colspan="4"><strong>Асинхронные действия</strong></td></tr><tr><td><code>ready</code></td><td>Проверка готовности async действия</td><td><code>{_async_action.ai_req_1|ready}</code></td><td><code>true</code> если завершено, <code>false</code> если выполняется</td></tr><tr><td><code>not_ready</code></td><td>Проверка что действие ещё выполняется</td><td><code>{_async_action.ai_req_1|not_ready}</code></td><td><code>true</code> если выполняется, <code>false</code> если готово</td></tr></tbody></table><h2 id="примеры-использования" tabindex="-1">Примеры использования: <a class="header-anchor" href="#примеры-использования" aria-label="Permalink to &quot;Примеры использования:&quot;">​</a></h2><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Простые операции</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{value|+100|format:currency}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Условная логика</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{user_status|equals:active|value:Активен|fallback:Неактивен}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Цепочка модификаторов</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  formatted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{price|*0.9|format:currency|fallback:0.00 ₽}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Извлечение по regex (для обратных слешей — двойные кавычки!)</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  duration</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{event_text|regex:(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">d+)</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s*min|fallback:0}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Точечная нотация</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{user.profile.name|fallback:Неизвестный}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Временные значения</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  duration_seconds</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{duration|seconds}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  duration_minutes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{duration|seconds|/60}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  duration_hours</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{duration|seconds|/3600}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  formatted_time</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{duration|seconds|format:number}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Сдвиг дат</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  tomorrow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{created|shift:+1 day}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  next_month</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{created|shift:+1 month|format:date}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  complex_shift</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{created|shift:+1 year 2 months|format:datetime}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Приведение к началу периода</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  start_of_day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{created|to_date}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  start_of_week</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{created|to_week}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  formatted_month_start</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{created|to_month|format:date}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Boolean поля (различать True/False/None)</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  is_active</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{is_active|equals:True|value:✅ Включено|fallback:{is_active|equals:False|value:❌ Выключено|fallback:❓ Неизвестно}}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  is_polling</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{is_polling|equals:True|value:✅ Активен|fallback:{is_polling|equals:False|value:❌ Неактивен|fallback:❓ Неизвестно}}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Строковые поля (используйте equals:value)</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{user_status|equals:active|value:Активен|fallback:Неактивен}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Упрощённый вариант (если None не ожидается)</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  is_simple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{is_active|true|value:✅ Включено|fallback:❌ Выключено}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Проверка существования значения (в условиях)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # В условиях: {field|exists} == True или {field|exists} == False</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Проверка на null (в условиях)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # В условиях: {field|is_null} == True или {field|is_null} == False</span></span></code></pre></div><p><strong>Пример использования exists в условиях:</strong></p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">step</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;validate&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      condition</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{response_value.feedback|exists} == True&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    transition</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">action_result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;success&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        transition_action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;continue&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Значение существует</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">action_result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;failed&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        transition_action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;jump_to_scenario&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        transition_value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;create_feedback&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Значение не существует</span></span></code></pre></div><h2 id="важно-boolean-и-строковые-поля" tabindex="-1">Важно: boolean и строковые поля <a class="header-anchor" href="#важно-boolean-и-строковые-поля" aria-label="Permalink to &quot;Важно: boolean и строковые поля&quot;">​</a></h2><p><strong>Для boolean полей (True/False):</strong></p><ul><li><strong>Рекомендуется:</strong> <code>{is_active|true|value:✅ Включено|fallback:❌ Выключено}</code></li><li><strong>Не работает:</strong> <code>{is_active|equals:true|value:✅ Включено}</code> (сравнение строк)</li></ul><p><strong>Для строковых полей:</strong></p><ul><li><strong>Используйте:</strong> <code>{status|equals:active|value:Активен|fallback:Неактивен}</code></li><li>Модификатор <code>true</code> не подходит для строковых значений</li></ul><h2 id="практические-примеры" tabindex="-1">Практические примеры <a class="header-anchor" href="#практические-примеры" aria-label="Permalink to &quot;Практические примеры&quot;">​</a></h2><h4 id="пример-1-персонализированное-приветствие" tabindex="-1"><strong>Пример 1: Персонализированное приветствие</strong> <a class="header-anchor" href="#пример-1-персонализированное-приветствие" aria-label="Permalink to &quot;**Пример 1: Персонализированное приветствие**&quot;">​</a></h4><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">step</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;send_message&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        👋 Привет, {username|fallback:Гость}!</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        📊 Ваша статистика:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        • ID: {user_id}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        • Чаты: {chat_count|fallback:0}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        • Последний вход: {last_login|format:datetime|fallback:Неизвестно}</span></span></code></pre></div><h4 id="пример-2-динамическое-меню-с-условиями" tabindex="-1"><strong>Пример 2: Динамическое меню с условиями</strong> <a class="header-anchor" href="#пример-2-динамическое-меню-с-условиями" aria-label="Permalink to &quot;**Пример 2: Динамическое меню с условиями**&quot;">​</a></h4><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">step</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;send_message&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        🎛️ Главное меню</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        Статус: {user_status|equals:active|value:✅ Активен|fallback:❌ Неактивен}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        Баланс: {balance|format:currency|fallback:0.00 ₽}</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      inline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        - [{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;📊 Статистика&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;stats&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}, {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;💰 Баланс&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;balance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        - [{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;⚙️ Настройки&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;settings&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}]</span></span></code></pre></div><h4 id="пример-3-обработка-ошибок-с-fallback" tabindex="-1"><strong>Пример 3: Обработка ошибок с fallback</strong> <a class="header-anchor" href="#пример-3-обработка-ошибок-с-fallback" aria-label="Permalink to &quot;**Пример 3: Обработка ошибок с fallback**&quot;">​</a></h4><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">step</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;send_message&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ❌ Ошибка обработки</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        Код ошибки: {error_code|fallback:НЕИЗВЕСТЕН}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        Сообщение: {error_message|fallback:Неизвестная ошибка}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        Время: {timestamp|format:datetime}</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      inline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        - [{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;🔄 Повторить&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;retry&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}, {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;🏠 Главное меню&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;main&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}]</span></span></code></pre></div><h4 id="пример-4-математические-расчеты" tabindex="-1"><strong>Пример 4: Математические расчёты</strong> <a class="header-anchor" href="#пример-4-математические-расчеты" aria-label="Permalink to &quot;**Пример 4: Математические расчёты**&quot;">​</a></h4><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">step</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;send_message&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        💰 Расчёт стоимости</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        Цена: {base_price|format:currency}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        Скидка: {discount_percent|fallback:0}%</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        Итого: {base_price|*{discount_percent|/100}|*{base_price|-1}|+{base_price}|format:currency}</span></span></code></pre></div><h4 id="пример-5-извлечение-данных-из-текста" tabindex="-1"><strong>Пример 5: Извлечение данных из текста</strong> <a class="header-anchor" href="#пример-5-извлечение-данных-из-текста" aria-label="Permalink to &quot;**Пример 5: Извлечение данных из текста**&quot;">​</a></h4><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">step</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;send_message&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        📝 Обработка заказа</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        Номер заказа: &quot;{event_text|regex:order\\s*(\\d+)|fallback:Не найден}&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        Сумма: &quot;{event_text|regex:amount\\s*(\\d+)|format:currency|fallback:0.00 ₽}&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        Время доставки: &quot;{event_text|regex:(\\d+)\\s*min|fallback:30}&quot; минут</span></span></code></pre></div><h4 id="пример-6-динамическая-клавиатура-с-модификатором-expand" tabindex="-1"><strong>Пример 6: Динамическая клавиатура с модификатором expand</strong> <a class="header-anchor" href="#пример-6-динамическая-клавиатура-с-модификатором-expand" aria-label="Permalink to &quot;**Пример 6: Динамическая клавиатура с модификатором expand**&quot;">​</a></h4><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">step</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Получаем список тенантов</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;get_tenants_list&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Строим динамическую клавиатуру из публичных тенантов</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;build_keyboard&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      items</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{public_tenant_ids}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      keyboard_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;inline&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      text_template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Tenant $value$&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      callback_template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;select_tenant_$value$&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      buttons_per_row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Отправляем сообщение с динамической клавиатурой и статичными кнопками</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;send_message&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Выберите тенант:&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      inline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{keyboard|expand}&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # Разворачиваем динамическую клавиатуру</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        - [{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;🔙 Назад&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;main_menu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}]      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Статичная кнопка</span></span></code></pre></div><p><strong>Как работает <code>expand</code>:</strong></p><ul><li>Модификатор <code>expand</code> разворачивает массив массивов на один уровень <strong>только при использовании в массиве</strong></li><li>В примере выше <code>{keyboard|expand}</code> в массиве <code>inline</code> разворачивает <code>[[{...}, {...}], [{...}]]</code> в <code>[{...}, {...}], [{...}]</code></li><li>Это позволяет комбинировать динамически сгенерированные строки клавиатуры со статичными строками</li><li><strong>Важно:</strong> <code>expand</code> работает только в контексте массива. В строке или словаре значение остаётся без изменений</li></ul><p><strong>Пример без expand (неправильно):</strong></p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">inline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{keyboard}&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                           # ❌ Получится [[[...]], [...]] - 3 уровня вложенности!</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - [{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;🔙 Назад&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;main_menu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}]</span></span></code></pre></div><p><strong>Пример с expand (правильно):</strong></p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">inline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{keyboard|expand}&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                     # ✅ Получится [[...], [...]] - 2 уровня вложенности</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - [{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;🔙 Назад&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;main_menu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}]</span></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><a class="VPLink link pager-link prev" href="/reference/EVENT_GUIDE" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Назад</span><span class="title" data-v-e257564d>Гайд по событиям</span><!--]--></a></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/reference/AI_MODELS_GUIDE" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Далее</span><span class="title" data-v-e257564d>Модели AI</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-5d98c3a5 data-v-e315a0ad><div class="container" data-v-e315a0ad><p class="message" data-v-e315a0ad>Coreness — Create. Automate. Scale.</p><p class="copyright" data-v-e315a0ad>MIT License</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"advanced_architecture.md\":\"CyI7LAGX\",\"advanced_index.md\":\"ael4oo8n\",\"advanced_logging_guide.md\":\"Z5x5D3EI\",\"advanced_plugin_config_guide.md\":\"Duj1tZdE\",\"advanced_plugins_guide.md\":\"CEQ8OveI\",\"advanced_readme.md\":\"lUBGUnRK\",\"advanced_settings_config_guide.md\":\"Adc6-cX7\",\"advanced_system_action_guide.md\":\"BKTwZWQC\",\"advanced_testing_guide.md\":\"CeqFxTly\",\"changelog.md\":\"CtHiPZYO\",\"en_advanced_architecture.md\":\"DLGinutJ\",\"en_advanced_index.md\":\"B5MaUjVy\",\"en_advanced_logging_guide.md\":\"BHDVL3sI\",\"en_advanced_plugin_config_guide.md\":\"iBNRmtHP\",\"en_advanced_plugins_guide.md\":\"ZxNSJeE4\",\"en_advanced_readme.md\":\"1V-Sqc9T\",\"en_advanced_settings_config_guide.md\":\"C9_tOw-x\",\"en_advanced_system_action_guide.md\":\"SQwwb2Q0\",\"en_advanced_testing_guide.md\":\"C7IbbLWU\",\"en_changelog.md\":\"CFAzQkMU\",\"en_getting-started_deployment.md\":\"CR_kmG0W\",\"en_getting-started_examples_guide.md\":\"D1aNQO2q\",\"en_getting-started_index.md\":\"CPQunD3m\",\"en_getting-started_master_bot_guide.md\":\"DjayZJwb\",\"en_getting-started_readme.md\":\"hvy-U97A\",\"en_guides_scenario_config_guide.md\":\"D9X6NUF5\",\"en_guides_storage_config_guide.md\":\"5HJoqveK\",\"en_guides_tenant_config_guide.md\":\"C3jxsWzZ\",\"en_index.md\":\"Do7yrWWp\",\"en_readme.md\":\"Db6GE396\",\"en_reference_action_guide.md\":\"iBovHh-S\",\"en_reference_ai_models_guide.md\":\"DGr-w8lB\",\"en_reference_event_guide.md\":\"D9LRMX1j\",\"en_reference_placeholders.md\":\"CgsPJmKB\",\"getting-started_deployment.md\":\"BmmHyySc\",\"getting-started_examples_guide.md\":\"DY8IHGuX\",\"getting-started_index.md\":\"BSQ6cXRe\",\"getting-started_master_bot_guide.md\":\"D8fC33FS\",\"getting-started_readme.md\":\"CRTrtDBn\",\"guides_scenario_config_guide.md\":\"hzeI6iij\",\"guides_storage_config_guide.md\":\"DjKhrqGa\",\"guides_tenant_config_guide.md\":\"D2Vmzdt0\",\"index.md\":\"B7K7cJN1\",\"readme.md\":\"7iygN7II\",\"reference_action_guide.md\":\"gMtIcOXb\",\"reference_ai_models_guide.md\":\"D_8VpV88\",\"reference_event_guide.md\":\"DQEwBhDP\",\"reference_placeholders.md\":\"BW8NJDzR\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"ru\",\"dir\":\"ltr\",\"title\":\"Coreness\",\"description\":\"Self-hosted multitenant platform for AI agents with event-driven architecture.\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":\"dark\",\"themeConfig\":{},\"locales\":{\"root\":{\"label\":\"Русский\",\"lang\":\"ru\",\"title\":\"Coreness\",\"description\":\"Самостоятельно размещаемая мультитенантная платформа для AI-агентов.\",\"themeConfig\":{\"sidebar\":[{\"text\":\"Начало\",\"items\":[{\"text\":\"Главная\",\"link\":\"/\"},{\"text\":\"Начало работы\",\"link\":\"/getting-started/\"},{\"text\":\"Практические примеры\",\"link\":\"/getting-started/EXAMPLES_GUIDE\"},{\"text\":\"Master Bot\",\"link\":\"/getting-started/MASTER_BOT_GUIDE\"}]},{\"text\":\"Развёртывание\",\"items\":[{\"text\":\"Развёртывание\",\"link\":\"/getting-started/DEPLOYMENT\"}]},{\"text\":\"Руководства\",\"items\":[{\"text\":\"Руководство по сценариям\",\"link\":\"/guides/SCENARIO_CONFIG_GUIDE\"},{\"text\":\"Конфигурация тенантов\",\"link\":\"/guides/TENANT_CONFIG_GUIDE\"},{\"text\":\"Хранилище атрибутов\",\"link\":\"/guides/STORAGE_CONFIG_GUIDE\"}]},{\"text\":\"Справочники\",\"items\":[{\"text\":\"Гайд по действиям\",\"link\":\"/reference/ACTION_GUIDE\"},{\"text\":\"Гайд по событиям\",\"link\":\"/reference/EVENT_GUIDE\"},{\"text\":\"Плейсхолдеры\",\"link\":\"/reference/PLACEHOLDERS\"},{\"text\":\"Модели AI\",\"link\":\"/reference/AI_MODELS_GUIDE\"}]},{\"text\":\"Прочее\",\"items\":[{\"text\":\"Changelog\",\"link\":\"/CHANGELOG\"}]},{\"text\":\"Расширенная документация\",\"collapsed\":true,\"items\":[{\"text\":\"Обзор\",\"link\":\"/advanced/\"},{\"text\":\"Архитектура\",\"link\":\"/advanced/ARCHITECTURE\"},{\"text\":\"Плагины\",\"link\":\"/advanced/PLUGINS_GUIDE\"},{\"text\":\"Конфигурация плагинов\",\"link\":\"/advanced/PLUGIN_CONFIG_GUIDE\"},{\"text\":\"Системные действия\",\"link\":\"/advanced/SYSTEM_ACTION_GUIDE\"},{\"text\":\"Настройка системы\",\"link\":\"/advanced/SETTINGS_CONFIG_GUIDE\"},{\"text\":\"Логирование\",\"link\":\"/advanced/LOGGING_GUIDE\"},{\"text\":\"Тестирование\",\"link\":\"/advanced/TESTING_GUIDE\"}]}],\"nav\":[{\"text\":\"Coreness.tech\",\"link\":\"https://coreness.tech\",\"target\":\"_blank\"},{\"text\":\"GitHub\",\"link\":\"https://github.com/Vensus137/Coreness\",\"target\":\"_blank\"}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/Vensus137/Coreness\",\"ariaLabel\":\"GitHub\"}],\"footer\":{\"message\":\"Coreness — Create. Automate. Scale.\",\"copyright\":\"MIT License\"},\"docFooter\":{\"prev\":\"Назад\",\"next\":\"Далее\"},\"outlineTitle\":\"На этой странице\",\"returnToTopLabel\":\"Вверх\",\"sidebarMenuLabel\":\"Меню\",\"darkModeSwitchLabel\":\"Тема\"}},\"en\":{\"label\":\"English\",\"lang\":\"en\",\"link\":\"/en/\",\"title\":\"Coreness\",\"description\":\"Self-hosted multitenant platform for AI agents.\",\"themeConfig\":{\"sidebar\":[{\"text\":\"Getting started\",\"items\":[{\"text\":\"Home\",\"link\":\"/en/\"},{\"text\":\"Getting started\",\"link\":\"/en/getting-started/\"},{\"text\":\"Practical examples\",\"link\":\"/en/getting-started/EXAMPLES_GUIDE\"},{\"text\":\"Master Bot\",\"link\":\"/en/getting-started/MASTER_BOT_GUIDE\"}]},{\"text\":\"Deployment\",\"items\":[{\"text\":\"Deployment\",\"link\":\"/en/getting-started/DEPLOYMENT\"}]},{\"text\":\"Guides\",\"items\":[{\"text\":\"Scenario guide\",\"link\":\"/en/guides/SCENARIO_CONFIG_GUIDE\"},{\"text\":\"Tenant configuration\",\"link\":\"/en/guides/TENANT_CONFIG_GUIDE\"},{\"text\":\"Storage attributes\",\"link\":\"/en/guides/STORAGE_CONFIG_GUIDE\"}]},{\"text\":\"Reference\",\"items\":[{\"text\":\"Actions guide\",\"link\":\"/en/reference/ACTION_GUIDE\"},{\"text\":\"Events guide\",\"link\":\"/en/reference/EVENT_GUIDE\"},{\"text\":\"Placeholders\",\"link\":\"/en/reference/PLACEHOLDERS\"},{\"text\":\"AI models\",\"link\":\"/en/reference/AI_MODELS_GUIDE\"}]},{\"text\":\"Other\",\"items\":[{\"text\":\"Changelog\",\"link\":\"/en/CHANGELOG\"}]},{\"text\":\"Advanced documentation\",\"collapsed\":true,\"items\":[{\"text\":\"Overview\",\"link\":\"/en/advanced/\"},{\"text\":\"Architecture\",\"link\":\"/en/advanced/ARCHITECTURE\"},{\"text\":\"Plugins\",\"link\":\"/en/advanced/PLUGINS_GUIDE\"},{\"text\":\"Plugin configuration\",\"link\":\"/en/advanced/PLUGIN_CONFIG_GUIDE\"},{\"text\":\"System actions\",\"link\":\"/en/advanced/SYSTEM_ACTION_GUIDE\"},{\"text\":\"System settings\",\"link\":\"/en/advanced/SETTINGS_CONFIG_GUIDE\"},{\"text\":\"Logging\",\"link\":\"/en/advanced/LOGGING_GUIDE\"},{\"text\":\"Testing\",\"link\":\"/en/advanced/TESTING_GUIDE\"}]}],\"nav\":[{\"text\":\"Coreness.tech\",\"link\":\"https://coreness.tech\",\"target\":\"_blank\"},{\"text\":\"GitHub\",\"link\":\"https://github.com/Vensus137/Coreness\",\"target\":\"_blank\"}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/Vensus137/Coreness\",\"ariaLabel\":\"GitHub\"}],\"footer\":{\"message\":\"Coreness — Create. Automate. Scale.\",\"copyright\":\"MIT License\"},\"docFooter\":{\"prev\":\"Previous\",\"next\":\"Next\"}}}},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>